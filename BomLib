local function CreateWindow(options)
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = options.Name or "Window"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = game.Players.LocalPlayer.PlayerGui

    local window = Instance.new("Frame")
    window.Size = UDim2.new(0, 520, 0, 300)
    window.Position = UDim2.new(-0.5, -260, 0.5, -150) -- Começa fora da tela à esquerda
    window.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    window.BorderSizePixel = 0
    window.BackgroundTransparency = 0
    window.Parent = screenGui
    window.Active = true
    window.Draggable = true
    window.Visible = true
    window.ClipsDescendants = true

    local u = Instance.new("UICorner")
    u.CornerRadius = UDim.new(0, 8)
    u.Parent = window

    local s = Instance.new("UIStroke")
    s.ApplyStrokeMode = Enum.ApplyStrokeMode.Contextual
    s.Color = Color3.new(0, 0, 0)
    s.Thickness = 1
    s.Parent = window

    local topBar = Instance.new("Frame")
    topBar.Size = UDim2.new(1, 0, 0, 40)
    topBar.BackgroundColor3 = Color3.new(0.15, 0.15, 0.15)
    topBar.BorderSizePixel = 0
    topBar.Parent = window

    local uu = Instance.new("UICorner")
    uu.CornerRadius = UDim.new(0, 8)
    uu.Parent = topBar

    local Frame = Instance.new("Frame")
    Frame.BackgroundColor3 = Color3.new(0.14902, 0.14902, 0.14902)
    Frame.Position = UDim2.new(0, 0, 0, 35)
    Frame.Size = UDim2.new(1, 0, 0, 8)
    Frame.Parent = topBar
    Frame.BackgroundTransparency = 1

    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -80, 1, 0)
    titleLabel.Position = UDim2.new(0, 10, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextColor3 = Color3.new(1, 1, 1)
    titleLabel.Text = options.Name or "Window"
    titleLabel.TextSize = 18
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = topBar

    local closeButton = Instance.new("TextButton")
    closeButton.Size = UDim2.new(0, 30, 0, 30)
    closeButton.Position = UDim2.new(1, -35, 0, 5)
    closeButton.BackgroundColor3 = Color3.new(0.8, 0.2, 0.2)
    closeButton.TextColor3 = Color3.new(1, 1, 1)
    closeButton.Text = "X"
    closeButton.Parent = topBar

    closeButton.MouseButton1Click:Connect(function()
        local tweenService = game:GetService("TweenService")
        local tweenInfo = TweenInfo.new(0.9, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        local closeTween = tweenService:Create(window, tweenInfo, {Position = UDim2.new(1.5, -260, 0.5, -150)}) -- Desliza para fora da tela à direita

        closeTween:Play()
        closeTween.Completed:Connect(function()
            screenGui:Destroy()
        end)
    end)

    local u7 = Instance.new("UICorner")
    u7.CornerRadius = UDim.new(0, 8)
    u7.Parent = closeButton

    local ss2 = Instance.new("UIStroke")
    ss2.ApplyStrokeMode = Enum.ApplyStrokeMode.Contextual
    ss2.Color = Color3.new(0, 0, 0)
    ss2.Thickness = 1
    ss2.Parent = closeButton

    local ss3 = Instance.new("UIStroke")
    ss3.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    ss3.Color = Color3.new(0, 0, 0)
    ss3.Thickness = 1
    ss3.Parent = closeButton

    local minimizeButton = Instance.new("TextButton")
    minimizeButton.Size = UDim2.new(0, 30, 0, 30)
    minimizeButton.Position = UDim2.new(1, -70, 0, 5)
    minimizeButton.BackgroundColor3 = Color3.new(0.5, 0.5, 0.5)
    minimizeButton.TextColor3 = Color3.new(1, 1, 1)
    minimizeButton.Text = "-"
    minimizeButton.Parent = topBar

    local u77 = Instance.new("UICorner")
    u77.CornerRadius = UDim.new(0, 8)
    u77.Parent = minimizeButton

    local sss2 = Instance.new("UIStroke")
    sss2.ApplyStrokeMode = Enum.ApplyStrokeMode.Contextual
    sss2.Color = Color3.new(0, 0, 0)
    sss2.Thickness = 1
    sss2.Parent = minimizeButton

    local sss3 = Instance.new("UIStroke")
    sss3.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    sss3.Color = Color3.new(0, 0, 0)
    sss3.Thickness = 1
    sss3.Parent = minimizeButton

    local tabPanel = Instance.new("ScrollingFrame")
    tabPanel.Size = UDim2.new(0, 110, 0, 250)
    tabPanel.Position = UDim2.new(0, 0, 0, 40)
    tabPanel.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    tabPanel.BorderSizePixel = 0
    tabPanel.CanvasSize = UDim2.new(0, 0, 1, 0)
    tabPanel.ScrollBarThickness = 6
    tabPanel.ScrollBarImageColor3 = Color3.new(0.7, 0.7, 0.7)
    tabPanel.Parent = window
    tabPanel.Visible = true

    local tabListLayout = Instance.new("UIListLayout")
    tabListLayout.Parent = tabPanel
    tabListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    tabListLayout.Padding = UDim.new(0, 10)

    local tabPadding = Instance.new("UIPadding")
    tabPadding.PaddingTop = UDim.new(0, 10)
    tabPadding.PaddingBottom = UDim.new(0, 10)
    tabPadding.PaddingLeft = UDim.new(0, 10)
    tabPadding.PaddingRight = UDim.new(0, 10)
    tabPadding.Parent = tabPanel

    local mainFrame = Instance.new("ScrollingFrame")
    mainFrame.Size = UDim2.new(1, -110, 0, 250)
    mainFrame.Position = UDim2.new(0, 110, 0, 40)
    mainFrame.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
    mainFrame.BorderSizePixel = 0
    mainFrame.CanvasSize = UDim2.new(0, 0, 0, 1000)
    mainFrame.ScrollBarThickness = 6
    mainFrame.ScrollBarImageColor3 = Color3.new(0.7, 0.7, 0.7)
    mainFrame.Parent = window

    local uiListLayout = Instance.new("UIListLayout")
    uiListLayout.Parent = mainFrame
    uiListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    uiListLayout.Padding = UDim.new(0, 10)

    local uiPadding = Instance.new("UIPadding")
    uiPadding.PaddingTop = UDim.new(0, 10)
    uiPadding.PaddingBottom = UDim.new(0, 10)
    uiPadding.PaddingLeft = UDim.new(0, 10)
    uiPadding.PaddingRight = UDim.new(0, 10)
    uiPadding.Parent = mainFrame

    -- Funções de Minimização/Maximização
    local isMinimized = false

    local function animateFrameSize(targetSize, mainFramTargetSize, topBarTargetSize, tabPanelTargetSize)
        local tweenService = game:GetService("TweenService")
        local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)

        local frameTween = tweenService:Create(window, tweenInfo, {Size = targetSize})
        local frameTabTween = tweenService:Create(mainFrame, tweenInfo, {Size = mainFramTargetSize})
        local topBarTween = tweenService:Create(topBar, tweenInfo, {Size = topBarTargetSize})
        local tabPanelTween = tweenService:Create(tabPanel, tweenInfo, {Size = tabPanelTargetSize})

        frameTween:Play()
        frameTabTween:Play()
        topBarTween:Play()
        tabPanelTween:Play()

        frameTween.Completed:Wait()
        frameTabTween.Completed:Wait()
        topBarTween.Completed:Wait()
        tabPanelTween.Completed:Wait()
    end

        minimizeButton.MouseButton1Click:Connect(function()
        isMinimized = not isMinimized
        if isMinimized then
            animateFrameSize(UDim2.new(0, 520, 0, 40), UDim2.new(0, 410, 0, 0), UDim2.new(1, 0, 0, 40), UDim2.new(0, 110, 0, 0))
        else
            animateFrameSize(UDim2.new(0, 520, 0, 300), UDim2.new(0, 410, 0, 250), UDim2.new(1, 0, 0, 40), UDim2.new(0, 110, 0, 260))
        end
    end)

    local function ensureTabPanelVisible()
        if not tabPanel.Visible and not isMinimized then
            while not isMinimized and not tabPanel.Visible do
                wait(0)
                tabPanel.Visible = true
            end
        end
    end

    tabPanel:GetPropertyChangedSignal("Visible"):Connect(ensureTabPanelVisible)
    minimizeButton.MouseButton1Click:Connect(ensureTabPanelVisible)

    -- Animação de inicialização
    local tweenService = game:GetService("TweenService")
    local tweenInfo = TweenInfo.new(1.7, Enum.EasingStyle.Bounce, Enum.EasingDirection.Out)
    local openTween = tweenService:Create(window, tweenInfo, {Position = UDim2.new(0.5, -260, 0.5, -150)}) -- Desliza para o centro da tela
    openTween:Play()

    return window
end

return CreateWindow
