local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Camera = game.Workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer

local function DrawCornerBox(Position, Size, Color)
    local thickness = 2  -- Ajuste a espessura dos cantos
    local cornerLength = Size.X * 0.2  -- Percentual do tamanho da caixa para os cantos
    
    -- Linhas superiores
    local TopLeft = Drawing.new("Line")
    TopLeft.From = Position
    TopLeft.To = Position + Vector2.new(cornerLength, 0)
    TopLeft.Color = Color
    TopLeft.Thickness = thickness
    TopLeft.Visible = true
    
    local TopLeftVertical = Drawing.new("Line")
    TopLeftVertical.From = Position
    TopLeftVertical.To = Position + Vector2.new(0, cornerLength)
    TopLeftVertical.Color = Color
    TopLeftVertical.Thickness = thickness
    TopLeftVertical.Visible = true
    
    local TopRight = Drawing.new("Line")
    TopRight.From = Position + Vector2.new(Size.X, 0)
    TopRight.To = TopRight.From - Vector2.new(cornerLength, 0)
    TopRight.Color = Color
    TopRight.Thickness = thickness
    TopRight.Visible = true
    
    local TopRightVertical = Drawing.new("Line")
    TopRightVertical.From = Position + Vector2.new(Size.X, 0)
    TopRightVertical.To = TopRightVertical.From + Vector2.new(0, cornerLength)
    TopRightVertical.Color = Color
    TopRightVertical.Thickness = thickness
    TopRightVertical.Visible = true
    
    -- Linhas inferiores
    local BottomLeft = Drawing.new("Line")
    BottomLeft.From = Position + Vector2.new(0, Size.Y)
    BottomLeft.To = BottomLeft.From + Vector2.new(cornerLength, 0)
    BottomLeft.Color = Color
    BottomLeft.Thickness = thickness
    BottomLeft.Visible = true
    
    local BottomLeftVertical = Drawing.new("Line")
    BottomLeftVertical.From = Position + Vector2.new(0, Size.Y)
    BottomLeftVertical.To = BottomLeftVertical.From - Vector2.new(0, cornerLength)
    BottomLeftVertical.Color = Color
    BottomLeftVertical.Thickness = thickness
    BottomLeftVertical.Visible = true
    
    local BottomRight = Drawing.new("Line")
    BottomRight.From = Position + Size
    BottomRight.To = BottomRight.From - Vector2.new(cornerLength, 0)
    BottomRight.Color = Color
    BottomRight.Thickness = thickness
    BottomRight.Visible = true
    
    local BottomRightVertical = Drawing.new("Line")
    BottomRightVertical.From = Position + Size
    BottomRightVertical.To = BottomRightVertical.From - Vector2.new(0, cornerLength)
    BottomRightVertical.Color = Color
    BottomRightVertical.Thickness = thickness
    BottomRightVertical.Visible = true
    
    return {TopLeft, TopLeftVertical, TopRight, TopRightVertical, BottomLeft, BottomLeftVertical, BottomRight, BottomRightVertical}
end

RunService.RenderStepped:Connect(function()
    for _, v in pairs(Players:GetPlayers()) do
        if v ~= LocalPlayer and v.Character and v.Character:FindFirstChild("HumanoidRootPart") then
            local RootPart = v.Character.HumanoidRootPart
            local Head = v.Character.Head
            
            local HeadOff = Vector3.new(0, 0.5, 0)
            local LegOff = Vector3.new(0, 3, 0)
            
            local RootPosition, RootVis = Camera:WorldToViewportPoint(RootPart.Position)
            local HeadPosition = Camera:WorldToViewportPoint(Head.Position + HeadOff)
            local LegPosition = Camera:WorldToViewportPoint(RootPart.Position - LegOff)
            
            if RootVis then
                local BoxSize = Vector2.new(1000 / RootPosition.Z, HeadPosition.Y - LegPosition.Y)
                local BoxPosition = Vector2.new(RootPosition.X - BoxSize.X / 2, RootPosition.Y - BoxSize.Y / 2)
                
                DrawCornerBox(BoxPosition, BoxSize, Color3.fromRGB(255, 0, 0))
            end
        end
    end
end)
